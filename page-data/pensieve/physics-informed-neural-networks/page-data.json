{"componentChunkName":"component---src-templates-post-js","path":"/pensieve/physics-informed-neural-networks/","result":{"data":{"markdownRemark":{"html":"<h2>Introduction</h2>\n<p>Physics-Informed Neural Networks (PINNs) represent a paradigm shift in how we approach problems that lie at the intersection of physics and machine learning. Rather than treating neural networks as black boxes that learn purely from data, PINNs encode the fundamental laws of physics directly into the loss function — ensuring that predictions remain physically consistent.</p>\n<p>In this post, I'll share my experience building the core engine for <strong>Fairway Golf Simulator</strong>, where we used PINNs combined with traditional ANNs to predict golf ball trajectory with remarkable accuracy.</p>\n<h2>The Problem</h2>\n<p>Golf ball physics is deceptively complex. A ball in flight is affected by:</p>\n<ul>\n<li><strong>Gravity</strong> — the constant downward acceleration</li>\n<li><strong>Aerodynamic drag</strong> — resistance proportional to velocity squared</li>\n<li><strong>Magnus effect</strong> — spin-induced lift that causes hooks and slices</li>\n<li><strong>Wind</strong> — external force vectors varying by altitude</li>\n<li><strong>Ground interaction</strong> — bounce, roll, and friction on landing</li>\n</ul>\n<p>Traditional physics engines can model these forces, but they require precise initial conditions and material properties that are difficult to measure in practice. Pure data-driven approaches, on the other hand, require enormous datasets and often produce physically implausible predictions.</p>\n<h2>Why PINNs?</h2>\n<p>PINNs offer the best of both worlds. The key insight is embedding the governing differential equations directly into the neural network's training process.</p>\n<p>For a golf ball in flight, the equations of motion are:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">m * d²x/dt² = F_drag_x + F_magnus_x + F_wind_x\nm * d²y/dt² = F_drag_y + F_magnus_y + F_wind_y - m*g\nm * d²z/dt² = F_drag_z + F_magnus_z + F_wind_z</code></pre></div>\n<p>In a PINN framework, we define a composite loss function:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">loss <span class=\"token operator\">=</span> loss_data <span class=\"token operator\">+</span> lambda_physics <span class=\"token operator\">*</span> loss_physics\n\n<span class=\"token comment\"># loss_data: MSE between predictions and observed trajectories</span>\n<span class=\"token comment\"># loss_physics: Residual of the governing PDEs evaluated at collocation points</span></code></pre></div>\n<p>The physics loss acts as a regularizer, ensuring the network's predictions satisfy physical laws even in regions with sparse training data.</p>\n<h2>Architecture</h2>\n<p>Our implementation used PyTorch with the following architecture:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">GolfPINN</span><span class=\"token punctuation\">(</span>nn<span class=\"token punctuation\">.</span>Module<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>net <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>Sequential<span class=\"token punctuation\">(</span>\n            nn<span class=\"token punctuation\">.</span>Linear<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>      <span class=\"token comment\"># Input: time t</span>\n            nn<span class=\"token punctuation\">.</span>Tanh<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            nn<span class=\"token punctuation\">.</span>Linear<span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            nn<span class=\"token punctuation\">.</span>Tanh<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            nn<span class=\"token punctuation\">.</span>Linear<span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            nn<span class=\"token punctuation\">.</span>Tanh<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            nn<span class=\"token punctuation\">.</span>Linear<span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>      <span class=\"token comment\"># Output: x, y, z, vx, vy, vz</span>\n        <span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">forward</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> self<span class=\"token punctuation\">.</span>net<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span></code></pre></div>\n<p>The physics residual is computed using automatic differentiation:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">physics_loss</span><span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    t<span class=\"token punctuation\">.</span>requires_grad_<span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n    output <span class=\"token operator\">=</span> model<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span>\n    x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z <span class=\"token operator\">=</span> output<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> output<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> output<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\n    vx<span class=\"token punctuation\">,</span> vy<span class=\"token punctuation\">,</span> vz <span class=\"token operator\">=</span> output<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> output<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">:</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> output<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">:</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token comment\"># Compute accelerations via autograd</span>\n    ax <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>autograd<span class=\"token punctuation\">.</span>grad<span class=\"token punctuation\">(</span>vx<span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">,</span> torch<span class=\"token punctuation\">.</span>ones_like<span class=\"token punctuation\">(</span>vx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> create_graph<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    ay <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>autograd<span class=\"token punctuation\">.</span>grad<span class=\"token punctuation\">(</span>vy<span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">,</span> torch<span class=\"token punctuation\">.</span>ones_like<span class=\"token punctuation\">(</span>vy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> create_graph<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    az <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>autograd<span class=\"token punctuation\">.</span>grad<span class=\"token punctuation\">(</span>vz<span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">,</span> torch<span class=\"token punctuation\">.</span>ones_like<span class=\"token punctuation\">(</span>vz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> create_graph<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token comment\"># Physics: F = ma</span>\n    drag <span class=\"token operator\">=</span> compute_drag<span class=\"token punctuation\">(</span>vx<span class=\"token punctuation\">,</span> vy<span class=\"token punctuation\">,</span> vz<span class=\"token punctuation\">)</span>\n    magnus <span class=\"token operator\">=</span> compute_magnus<span class=\"token punctuation\">(</span>vx<span class=\"token punctuation\">,</span> vy<span class=\"token punctuation\">,</span> vz<span class=\"token punctuation\">,</span> spin<span class=\"token punctuation\">)</span>\n\n    residual_x <span class=\"token operator\">=</span> ax <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>drag<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> magnus<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> mass\n    residual_y <span class=\"token operator\">=</span> ay <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>drag<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> magnus<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> g<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> mass\n    residual_z <span class=\"token operator\">=</span> az <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>drag<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> magnus<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> mass\n\n    <span class=\"token keyword\">return</span> torch<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span>residual_x<span class=\"token operator\">**</span><span class=\"token number\">2</span> <span class=\"token operator\">+</span> residual_y<span class=\"token operator\">**</span><span class=\"token number\">2</span> <span class=\"token operator\">+</span> residual_z<span class=\"token operator\">**</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Results</h2>\n<p>The PINN model achieved significantly better generalization compared to a pure data-driven ANN, especially for:</p>\n<ul>\n<li><strong>Extreme spin conditions</strong> — where training data was sparse</li>\n<li><strong>Variable wind scenarios</strong> — the physics constraint ensured realistic deflection</li>\n<li><strong>Long-range predictions</strong> — error accumulation was much lower than pure ANNs</li>\n</ul>\n<p>The combined system now powers the Fairway Simulator, processing player input in real-time to predict trajectory with high fidelity.</p>\n<h2>Key Takeaways</h2>\n<ol>\n<li><strong>PINNs shine when data is limited</strong> — physics constraints act as powerful regularizers</li>\n<li><strong>Automatic differentiation is the secret weapon</strong> — PyTorch's autograd makes computing PDE residuals trivial</li>\n<li><strong>The physics loss weight (λ) matters</strong> — too low and you lose physical consistency, too high and you underfit the data</li>\n<li><strong>Hybrid approaches work best</strong> — we used PINNs for trajectory prediction and traditional ANNs for player skill assessment</li>\n</ol>\n<h2>What's Next</h2>\n<p>We're exploring adaptive collocation point sampling and multi-fidelity PINNs to further improve accuracy while reducing training time. The framework generalizes well beyond golf — any domain where physics models exist but data is scarce can benefit from this approach.</p>\n<hr>\n<p><em>This post is based on my work at Orbit Tech Solution building the Fairway Golf Engine.</em></p>","frontmatter":{"title":"Physics-Informed Neural Networks: Bridging Physics and Deep Learning","description":"A deep dive into PINNs — how we combined physics engines with neural networks to predict ball trajectory in a hyper-realistic golf simulator.","date":"2024-11-15","slug":"/pensieve/physics-informed-neural-networks","tags":["Machine Learning","Physics","PyTorch","PINNs"]}}},"pageContext":{"slug":"/pensieve/physics-informed-neural-networks"}},"staticQueryHashes":["3115057458"],"slicesMap":{}}